# Word Template Examples

This document provides examples of how to create custom Word templates for transcription exports.

## Template Basics

Word templates use placeholders that are replaced with actual data during export. Placeholders are enclosed in double curly braces: `{{placeholder_name}}`

## Available Placeholders

| Placeholder | Description | Example Output |
|------------|-------------|----------------|
| `{{title}}` | Document title | "Transcription Report" |
| `{{date}}` | Export date and time | "2025-10-01 14:30:25" |
| `{{duration}}` | Audio duration | "120.50 seconds" |
| `{{num_speakers}}` | Number of speakers | "3" |
| `{{language}}` | Detected language | "EN" |
| `{{total_segments}}` | Total segments | "45" |
| `{{TRANSCRIPTION}}` | **Special marker** for segment insertion | _(segments inserted here)_ |

## Example Templates

### Example 1: Simple Template

This is the most basic template structure:

```
{{title}}

Date: {{date}}
Duration: {{duration}}
Speakers: {{num_speakers}}

Transcription:

{{TRANSCRIPTION}}
```

### Example 2: Professional Template

A more formatted template with sections:

```
[Header]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{{title}}
Audio Transcription Report
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[Metadata Section]
Document Information
────────────────────

┌─────────────────────┬──────────────────────────┐
│ Field               │ Value                    │
├─────────────────────┼──────────────────────────┤
│ Export Date         │ {{date}}                 │
│ Audio Duration      │ {{duration}}             │
│ Number of Speakers  │ {{num_speakers}}         │
│ Language            │ {{language}}             │
│ Total Segments      │ {{total_segments}}       │
└─────────────────────┴──────────────────────────┘

[Transcription Section]
Transcription
─────────────

{{TRANSCRIPTION}}

[Footer]
────────────────────────────────────────────────
Generated by Audio Scribe AI
Confidential - Do Not Distribute
────────────────────────────────────────────────
```

### Example 3: Meeting Minutes Template

Template styled for meeting transcriptions:

```
[Company Logo Area]

MEETING TRANSCRIPTION
═════════════════════

Meeting Details
───────────────
Date: {{date}}
Duration: {{duration}}
Participants: {{num_speakers}} speakers
Language: {{language}}

Transcript
──────────

{{TRANSCRIPTION}}

Summary
───────
Total speaking turns: {{total_segments}}

This is an automated transcription and may contain errors.
Please review for accuracy.

──────────────────────────────────────────────
Internal Use Only | Generated by Audio Scribe AI
──────────────────────────────────────────────
```

### Example 4: Interview Template

Template for interview transcriptions:

```
INTERVIEW TRANSCRIPT
═══════════════════

Interview Information
─────────────────────
Recorded: {{date}}
Length: {{duration}}
Participants: {{num_speakers}}
Language: {{language}}

Transcript
──────────

{{TRANSCRIPTION}}

Notes
─────
• This transcript contains {{total_segments}} speaking turns
• Automated transcription - please verify accuracy
• Speaker identification is automated and may require verification

═══════════════════════════════════════════════
Confidential Interview Transcript
Generated: {{date}}
═══════════════════════════════════════════════
```

### Example 5: Academic Research Template

Template for research transcriptions:

```
Research Audio Transcription
═══════════════════════════

Study Documentation
──────────────────

╔══════════════════════╦════════════════════════╗
║ Parameter            ║ Value                  ║
╠══════════════════════╬════════════════════════╣
║ Transcription Date   ║ {{date}}               ║
║ Audio Duration       ║ {{duration}}           ║
║ Participant Count    ║ {{num_speakers}}       ║
║ Language Code        ║ {{language}}           ║
║ Segment Count        ║ {{total_segments}}     ║
╚══════════════════════╩════════════════════════╝

Research Transcript
──────────────────

{{TRANSCRIPTION}}

Methodology Notes
────────────────
Transcription Method: Automated Speech Recognition (ASR)
Model: KB-Whisper + Pyannote.audio
Speaker Diarization: Automated
Timestamp Precision: Second-level

Disclaimer: This automated transcription should be verified
against the original audio recording for research purposes.

═══════════════════════════════════════════════
Research Data | Handle According to Protocol
═══════════════════════════════════════════════
```

## Creating Your Own Template

### Step 1: Create a Word Document

1. Open Microsoft Word
2. Create a new document
3. Add your desired formatting, headers, footers, etc.

### Step 2: Insert Placeholders

1. Where you want dynamic data, type the placeholder
2. Example: `Date: {{date}}`
3. Format the text as desired (bold, colors, fonts, etc.)

### Step 3: Add Transcription Marker

1. Create a section where you want the transcription
2. Type `{{TRANSCRIPTION}}` on its own line
3. This is where speaker segments will be inserted

### Step 4: Style Your Document

1. Use Word's built-in styles (Heading 1, Heading 2, etc.)
2. Apply table styles for metadata
3. Add borders, colors, fonts as desired
4. The template formatting will be preserved

### Step 5: Save Template

1. Save as .docx format
2. Place in `backend/templates/word/` directory
3. Give it a descriptive name (e.g., `interview_template.docx`)

## Template Best Practices

### Do's ✓

- Use clear section headers
- Apply consistent formatting
- Use tables for metadata
- Include helpful context (e.g., "This is an automated transcription")
- Add company logos or branding if needed
- Use built-in Word styles for consistency
- Test your template with sample data

### Don'ts ✗

- Don't forget the `{{TRANSCRIPTION}}` marker
- Don't use complex macros or scripts
- Don't rely on external linked content
- Don't use placeholder names that don't exist
- Don't make the template too complex (keep it simple)

## Placeholder Formatting

You can format placeholders just like regular text:

- **Bold**: `**{{date}}**` → **2025-10-01 14:30:25**
- *Italic*: `*{{language}}*` → *EN*
- Colored: Apply color to `{{duration}}`
- Font: Change font of `{{title}}`

The placeholder will be replaced with the value while preserving the formatting!

## Advanced Techniques

### Using Placeholders in Tables

```
┌─────────────────┬─────────────┐
│ Duration        │ {{duration}} │
│ Speakers        │ {{num_speakers}} │
└─────────────────┴─────────────┘
```

### Using Placeholders in Headers/Footers

In Word header:
```
Transcription Report | {{date}}
```

In Word footer:
```
Page X of Y | {{language}} | {{num_speakers}} speakers
```

### Conditional Content

While templates don't support complex logic, you can prepare multiple templates for different scenarios:

- `interview_template.docx` - For interviews
- `meeting_template.docx` - For meetings
- `lecture_template.docx` - For lectures

## Testing Your Template

1. Create your template
2. Save it in `backend/templates/word/`
3. Run a transcription
4. Export using your template (via API or modify default)
5. Check the output
6. Refine formatting as needed

## Example API Call with Custom Template

```python
import requests

response = requests.post('http://localhost:8000/api/export/word', json={
    'transcription_data': your_transcription_data,
    'template_name': 'interview_template.docx'
})

with open('output.docx', 'wb') as f:
    f.write(response.content)
```

## Troubleshooting

**Placeholder not replaced?**
- Check spelling exactly: `{{duration}}` not `{{Duration}}`
- Ensure placeholder is surrounded by `{{` and `}}`

**Formatting lost?**
- Don't format the `{{` or `}}` separately from the placeholder name
- Format the entire placeholder as one unit

**Template not found?**
- Verify file is in `backend/templates/word/`
- Check filename matches exactly (case-sensitive on Linux)
- Ensure file has .docx extension

## Resources

- See [WORD_EXPORT_GUIDE.md](../../WORD_EXPORT_GUIDE.md) for more details
- Check [default_template.docx](word/default_template.docx) for reference
- Run `python create_default_template.py` to see template generation code

## Contributing Templates

If you create useful templates, consider sharing them! You can:
1. Add them to the repository
2. Share on the project discussions
3. Create a pull request with new template examples
